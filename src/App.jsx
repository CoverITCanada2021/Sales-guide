[Truncated placeholder: code is pulled from canvas directly]